<!DOCTYPE html>
<html lang="es">
<head>
	<!--
	Propósito: Página de inicio (index) minimalista y moderna de e-commerce.
	Relación: Consume APIs expuestas por `backend/server.js` y controlada por `public/js/app.js`.
	-->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>ModaNova - Tienda de Ropa</title>
	<!-- Bootstrap CSS (última estable 5.x) -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
	<!-- Bootstrap Icons -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
	<style>
		/* Estilos adaptados a tienda de ropa (paleta moderna) */
		:root {
			--brand-dark:#0f172a;
			--brand-accent:#e11d48; /* acento moda (secundario) */
			--brand-accent-2:#9333ea; /* acento 2 */
			--brand-blue-1:#2563eb; /* azul primario filtros */
			--brand-blue-2:#0ea5e9; /* azul degradado filtros */
			--muted:#64748b;
		}
		body { background-color:#f8fafc; color:var(--brand-dark); }
		.navbar { backdrop-filter:saturate(180%) blur(6px); }
		.card-img-top { object-fit:cover; height:220px; }
		.price { font-weight:700; color:var(--brand-dark); }
		.card { border: 1px solid #eef2f7; transition: transform .15s ease, box-shadow .15s ease; }
		.card:hover { transform: translateY(-2px); box-shadow: 0 8px 24px rgba(2,6,23,.08); }
		.hero {
			background: linear-gradient(180deg, #ffffff 0%, #f3f6fb 100%);
			border-bottom: 1px solid #e2e8f0;
		}
		.badge-stock { background-color:#ffe4e6; color:#9f1239; border:1px solid #fecdd3; }
		footer { color:var(--muted); }
		/* Filtro de categorías: nav-pills elegante y desplazable */
		#categoryFilters { overflow:auto; white-space:nowrap; }
		#categoryFilters .nav-link {
			border-radius: 999px;
			border: 1px solid #e5e7eb;
			color: #374151;
			background: #ffffff;
		}
		#categoryFilters .nav-link:hover { background:#f9fafb; }
		#categoryFilters .nav-link.active {
			background: linear-gradient(90deg, var(--brand-blue-1) 0%, var(--brand-blue-2) 100%);
			color:#fff;
			border-color: transparent;
		}
		/* Alto fijo para la fila de descuento y alinear inputs entre tarjetas */
		.discount-row { min-height: 26px; }
		/* Hero con fotos superpuestas (ropa) */
		.hero-figure { position: relative; min-height: 280px; }
		.hero-photo {
			border-radius: 1rem;
			box-shadow: 0 20px 40px rgba(2,6,23,.12);
			border: 1px solid #eef2f7;
		}
		.hero-photo.main { width: 68%; }
		.hero-photo.secondary {
			width: 46%;
			position: absolute;
			right: 0;
			bottom: -12px;
		}
	</style>
</head>
<body>
	<!-- Navbar -->
	<nav class="navbar navbar-expand-lg bg-white sticky-top border-bottom">
		<div class="container">
			<a class="navbar-brand fw-bold" href="/">
				<i class="bi bi-bag-heart me-2" style="color: var(--brand-accent);"></i>ModaNova
			</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarMain" aria-controls="navbarMain" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarMain">
				<ul class="navbar-nav me-auto mb-2 mb-lg-0">
					<li class="nav-item"><a class="nav-link active" aria-current="page" href="#">Inicio</a></li>
				</ul>
				<div class="d-flex align-items-center gap-2">
					<!-- Botón de autenticación (visible si NO autenticado) -->
					<button id="navLoginBtn" class="btn btn-outline-secondary d-none" type="button" data-bs-toggle="modal" data-bs-target="#authModal">
						<i class="bi bi-person"></i> Entrar
					</button>
					<!-- Dropdown de usuario (visible si autenticado) -->
					<div id="navUserDropdown" class="dropdown d-none">
						<button class="btn btn-outline-secondary dropdown-toggle d-flex align-items-center" type="button" data-bs-toggle="dropdown" aria-expanded="false">
							<i class="bi bi-person-circle me-2"></i><span id="navUserName" class="text-truncate" style="max-width:160px;"></span>
						</button>
						<ul class="dropdown-menu dropdown-menu-end">
							<li><button class="dropdown-item" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasProfile" aria-controls="offcanvasProfile"><i class="bi bi-person-gear me-2"></i>Mi perfil</button></li>
							<li><hr class="dropdown-divider"></li>
							<li><button id="navLogoutBtn" class="dropdown-item text-danger" type="button"><i class="bi bi-box-arrow-right me-2"></i>Cerrar sesión</button></li>
						</ul>
					</div>
					<button class="btn btn-outline-primary position-relative" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasCart" aria-controls="offcanvasCart">
						<i class="bi bi-cart3"></i>
						<span id="cartCountBadge" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
					</button>
				</div>
			</div>
		</div>
	</nav>

	<!-- Hero -->
	<section class="hero py-5">
		<div class="container">
			<div class="row align-items-center">
				<div class="col-md-7">
					<h1 class="display-5 fw-bold">Estrena hoy. Moda para todos los días.</h1>
					<p class="lead text-secondary">Básicos cómodos, prendas versátiles y tendencias que combinan con tu estilo. Envíos a todo el país y cambios fáciles.</p>
					<div class="d-flex flex-wrap gap-2 my-2">
						<span class="badge rounded-pill text-bg-light"><i class="bi bi-truck me-1"></i>Envío rápido</span>
						<span class="badge rounded-pill text-bg-light"><i class="bi bi-arrow-repeat me-1"></i>Cambios 30 días</span>
						<span class="badge rounded-pill text-bg-light"><i class="bi bi-shield-check me-1"></i>Pago seguro</span>
					</div>
					<a href="#catalogo" class="btn btn-primary btn-lg mt-2"><i class="bi bi-shop me-2"></i>Ver catálogo</a>
				</div>
				<div class="col-md-5 d-none d-md-block">
					<div class="hero-figure">
						<img class="hero-photo main" src="https://images.unsplash.com/photo-1519741497674-611481863552?auto=format&fit=crop&w=720&q=80" alt="Colección mujer">
						<img class="hero-photo secondary" src="https://images.unsplash.com/photo-1558769132-cb1aea458c5e?auto=format&fit=crop&w=600&q=80" alt="Colección hombre">
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- Grid de Productos -->
	<main class="py-5" id="catalogo">
		<div class="container">
			<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
				<h2 class="h4 m-0">Productos</h2>
				<div class="input-group" style="max-width: 700px;">
					<button id="categoryDropdownBtn" class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
						Categorías
					</button>
					<ul id="categoryDropdownMenu" class="dropdown-menu"></ul>
					<input id="searchInput" type="search" class="form-control" placeholder="Buscar prendas, marcas..." aria-label="Buscar producto">
					<button class="btn btn-primary" type="button" aria-label="Buscar"><i class="bi bi-search"></i></button>
				</div>
			</div>
			<!-- Filtros de categorías (píldoras) -->
			<div class="mb-3">
				<ul id="categoryFilters" class="nav nav-pills gap-2 small">
					<!-- Rellenado por app.js -->
				</ul>
			</div>
			<div id="productsGrid" class="row g-4">
				<!-- Productos renderizados por app.js -->
			</div>
		</div>
	</main>

	<!-- Offcanvas Carrito -->
	<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasCart" aria-labelledby="offcanvasCartLabel">
		<div class="offcanvas-header">
			<h5 class="offcanvas-title" id="offcanvasCartLabel"><i class="bi bi-cart3 me-2"></i>Carrito</h5>
			<button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
		</div>
		<div class="offcanvas-body d-flex flex-column">
			<div id="cartItems" class="list-group list-group-flush mb-3">
				<!-- Ítems del carrito renderizados por app.js -->
			</div>
			<div class="mt-auto">
				<div class="d-flex justify-content-between align-items-center mb-3">
					<span class="fw-semibold">Total:</span>
					<span id="cartTotal" class="h5 mb-0">$0</span>
				</div>
				<button id="checkoutBtn" class="btn btn-primary w-100"><i class="bi bi-credit-card me-2"></i>Finalizar compra</button>
			</div>
		</div>
	</div>

	<!-- Offcanvas Perfil -->
	<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasProfile" aria-labelledby="offcanvasProfileLabel">
		<div class="offcanvas-header">
			<h5 class="offcanvas-title" id="offcanvasProfileLabel"><i class="bi bi-person-gear me-2"></i>Mi perfil</h5>
			<button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
		</div>
		<div class="offcanvas-body">
			<!--
				Propósito: Panel de perfil del usuario para ver compras y actualizar datos.
				Relación: Controlado por `public/js/app.js` (render de compras, envío de formularios).
			-->
			<ul class="nav nav-tabs" id="profileTabs" role="tablist">
				<li class="nav-item" role="presentation">
					<button class="nav-link active" id="tab-compras" data-bs-toggle="tab" data-bs-target="#pane-compras" type="button" role="tab" aria-controls="pane-compras" aria-selected="true">
						<i class="bi bi-receipt-cutoff me-1"></i>Mis compras
					</button>
				</li>
				<li class="nav-item" role="presentation">
					<button class="nav-link" id="tab-cuenta" data-bs-toggle="tab" data-bs-target="#pane-cuenta" type="button" role="tab" aria-controls="pane-cuenta" aria-selected="false">
						<i class="bi bi-person-lines-fill me-1"></i>Mi cuenta
					</button>
				</li>
				<li class="nav-item" role="presentation">
					<button class="nav-link" id="tab-seguridad" data-bs-toggle="tab" data-bs-target="#pane-seguridad" type="button" role="tab" aria-controls="pane-seguridad" aria-selected="false">
						<i class="bi bi-shield-lock me-1"></i>Seguridad
					</button>
				</li>
			</ul>
			<div class="tab-content pt-3">
				<!-- Mis compras -->
				<div class="tab-pane fade show active" id="pane-compras" role="tabpanel" aria-labelledby="tab-compras" tabindex="0">
					<div id="myOrdersContainer" class="vstack gap-3">
						<!-- Renderizado dinámico por app.js -->
					</div>
				</div>
				<!-- Mi cuenta -->
				<div class="tab-pane fade" id="pane-cuenta" role="tabpanel" aria-labelledby="tab-cuenta" tabindex="0">
					<form id="profileForm" class="row g-3">
						<div class="col-12">
							<label class="form-label">Nombre</label>
							<input id="profileNombre" type="text" class="form-control" name="nombre" required>
						</div>
						<div class="col-12">
							<label class="form-label">Teléfono</label>
							<input id="profileTelefono" type="tel" class="form-control" name="telefono" placeholder="Opcional">
						</div>
						<div class="col-12 d-grid">
							<button class="btn btn-primary" type="submit"><i class="bi bi-save me-1"></i>Guardar cambios</button>
						</div>
					</form>
				</div>
				<!-- Seguridad -->
				<div class="tab-pane fade" id="pane-seguridad" role="tabpanel" aria-labelledby="tab-seguridad" tabindex="0">
					<form id="passwordForm" class="row g-3">
						<div class="col-12">
							<label class="form-label">Contraseña actual</label>
							<input type="password" class="form-control" name="actual" required>
						</div>
						<div class="col-12">
							<label class="form-label">Nueva contraseña</label>
							<input type="password" class="form-control" name="nueva" minlength="6" required>
						</div>
						<div class="col-12 d-grid">
							<button class="btn btn-warning" type="submit"><i class="bi bi-key-fill me-1"></i>Cambiar contraseña</button>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div>

	<!-- Modal Auth (Login / Registro) -->
	<div class="modal fade" id="authModal" tabindex="-1" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title"><i class="bi bi-person-lock me-2"></i>Accede para finalizar la compra</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
						<li class="nav-item" role="presentation">
							<button class="nav-link active" id="pills-login-tab" data-bs-toggle="pill" data-bs-target="#pills-login" type="button" role="tab" aria-controls="pills-login" aria-selected="true">Iniciar sesión</button>
						</li>
						<li class="nav-item" role="presentation">
							<button class="nav-link" id="pills-register-tab" data-bs-toggle="pill" data-bs-target="#pills-register" type="button" role="tab" aria-controls="pills-register" aria-selected="false">Registrarse</button>
						</li>
					</ul>
					<div class="tab-content" id="pills-tabContent">
						<div class="tab-pane fade show active" id="pills-login" role="tabpanel" aria-labelledby="pills-login-tab" tabindex="0">
							<form id="authLoginForm" class="row g-3">
								<div class="col-12">
									<label class="form-label">Correo</label>
									<input type="email" class="form-control" name="correo" required>
								</div>
								<div class="col-12">
									<label class="form-label">Contraseña</label>
									<input type="password" class="form-control" name="password" required>
								</div>
								<div class="col-12 d-grid">
									<button class="btn btn-primary" type="submit"><i class="bi bi-box-arrow-in-right me-1"></i>Entrar</button>
								</div>
							</form>
						</div>
						<div class="tab-pane fade" id="pills-register" role="tabpanel" aria-labelledby="pills-register-tab" tabindex="0">
							<form id="authRegisterForm" class="row g-3">
								<div class="col-md-6">
									<label class="form-label">Nombre</label>
									<input type="text" class="form-control" name="nombre" required>
								</div>
								<div class="col-md-6">
									<label class="form-label">Apellido</label>
									<input type="text" class="form-control" name="apellido" required>
								</div>
								<div class="col-12">
									<label class="form-label">Correo</label>
									<input type="email" class="form-control" name="correo" required>
								</div>
								<div class="col-12">
									<label class="form-label">Teléfono (opcional)</label>
									<input type="tel" class="form-control" name="telefono">
								</div>
								<div class="col-12">
									<label class="form-label">Contraseña</label>
									<input type="password" class="form-control" name="password" required>
								</div>
								<div class="col-12 d-grid">
									<button class="btn btn-success" type="submit"><i class="bi bi-person-plus me-1"></i>Crear cuenta</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<footer class="py-4 border-top">
		<div class="container small">
			<div class="d-flex justify-content-between align-items-center">
				<span>&copy; <span id="year"></span> Ecommerce Lab</span>
				<a class="text-decoration-none" href="#" onclick="window.scrollTo({ top: 0, behavior: 'smooth' })">
					Subir <i class="bi bi-arrow-up"></i>
				</a>
			</div>
		</div>
	</footer>

	<!-- Bootstrap Bundle + App -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
	<script src="/js/app.js"></script>
</body>
</html>


